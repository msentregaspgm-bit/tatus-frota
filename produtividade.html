<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Produtividade - Souza</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2e7d32">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #ffffff; font-family: 'Segoe UI', sans-serif; padding: 15px; transition: background-color 0.3s, color 0.3s; }
    body.dark-mode { background-color: #1b1f1b; color: #f4f4f4; }
    h1 { color: #2e7d32; text-align: center; margin-bottom: 20px; }
    .card { border-radius: 12px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); margin-bottom: 15px; background: #fff; }
    body.dark-mode .card { background-color: #2b2b2b; color: #fff; }
  </style>
</head>
<body>
  <h1>ðŸ“Š Produtividade da Frota</h1>
  <div class="text-center mb-3 d-flex justify-content-center gap-2">
    <button class="btn btn-outline-success btn-sm" onclick="window.location.href='index.html'">â¬… Voltar</button>
    <button id="refreshBtn" class="btn btn-success btn-sm">ðŸ”„ Atualizar</button>
    <button id="darkModeBtn" class="btn btn-outline-dark btn-sm">ðŸŒ™</button>
  </div>
  <div id="conteudo" class="container"></div>
  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbw871R1EIi_sdWpIBDPCcpBXrMaKH6Qmt_ypc7yT0NVxUjDkxqwkVV4KLNgTB3Cmed76A/exec";
    async function carregar() {
      const c = document.getElementById('conteudo');
      c.innerHTML = "<p class='text-center text-secondary'>Carregando...</p>";
      try {
        const r = await fetch(scriptURL + '?t=' + Date.now());
        const d = await r.json();
        c.innerHTML = "";
        d.forEach(b => {
          const card = document.createElement('div');
          card.className = 'card p-3';
          card.innerHTML = `<h5>${b.titulo || 'RelatÃ³rio'}</h5><div>${b.html || ''}</div>`;
          c.appendChild(card);
        });
      } catch(e){ c.innerHTML = "<p class='text-center text-danger'>Erro ao carregar dados.</p>"; }
    }
    document.getElementById('refreshBtn').addEventListener('click', carregar);
    document.getElementById('darkModeBtn').addEventListener('click', () => document.body.classList.toggle('dark-mode'));
    carregar();
  </script>
</body>
</html>